Creation date: 12.06.2024
Links:

---

Данная статья является кратким конспектом главы 2 части 2 "Численное представление" книги "Компьютерные системы. Архитектура и программирование".

## Представлние чисел без знака

Беззнаковые числа интерпретируются просто: число, состоящее из $w$ бит можно рассматривать как битовый вектор $u_w=[x_{w-1},x_{w-2},...,x_1,x_0]$, в котором вес каждого бита определяется как:
$$
W(x_i)=
\begin{cases}
2^i, \ x_i = 1 \\
0, \ \ x_i = 0
\end{cases}
$$
Тогда можно определить ф-ию $B2U_w(u)$, которая принимает битовый вектор, состоящий из $w$ бит, и возвращает натуральное число, являющееся интерпретацией данного битового вектора. Ф-ию $B2U_w(u)$ можно определить так:
$$
B2U_w(u) = \sum_i^{w-1}u_i*2^i
$$
## Представление знаковых чисел

Существует несколько способов представления беззнаковых чисел. Ниже представлены самые распространненые из них. В каждом из нижеприведенных способов знак числа кодируется старшим битом. Для каждого способа определяется функция $B2T_w(u)$, которая отображает битовый вектор длины $w$ в целое знаковое число.

### Дополнительный код

В дополнительном кода старший бит имеет вес $-2^{w-1}$. Тогда функция $B2T_w(u)$ вычисляется следующим образом:
$$
B2T_w(u)=-u_{w-1}*2^{w-1} + \sum_i^{w-2}u_i*2^i
$$
Функция $B2T_w(u)$ отображает битовый вектор $u$ длины $w$ в целое число из диапазона $[-2^{w-1};2^{w-1}-1]$

### Прямой код

В прямом коде старший бит определяет знак весов остальных битов. Функция $B2T_w(u)$ вычисляется следующим образом:
$$
B2T_w(u)=(-1)^{u_{w-1}}*\sum_i^{w-2}u_i*2^i
$$

### Обратный код

Обратный код похож на дополнительный код, за тем исключением, что он имеет вес $-(2^{w-1}-1)$. Функция $B2T_w(u)$ вычисляется следующим образом:

$$
B2T_w(u)=-u_{w-1}*(2^{w-1} - 1) + \sum_i^{w-2}u_i*2^i
$$

### Примеры

Возьмем битовый вектор $u_8=[1,0,1,0,1,0,1,0]$. Ниже представлены результаты интерпретации данного вектора с помощью приведенных выше трех способов:
* ДК: $B2U_8(u)=-2^7+2^5+2^3+2^1 = -86$ 
* ПК: $B2U_8(u)=(-1)^1*(2^5+2^3+2^1) = -42$ 
* ОК: $B2U_8(u)=-(2^7-1)+2^5+2^3+2^1=-85$ 

## Преобразование между знаковыми и беззнаковыми числами

Пусть есть битовый вектор длины $w$. Тогда $TMin_w$ и $TMax_w$ - минимальное и максимальное значения функции $B2T_w$ (в дополнительном коде), а $UMin_w$ и $UMax_w$ - минимальное и максимальное значения функции $B2U_w$ ($UMin_w==0$).

### Преобразование из числа, представленного в дополнительном коде, в беззнаковое число

Пусть $T2U_w(x)$ - отображение числа из диапазона $[TMin_w;TMax_w]$ в число из диапазона $[UMin_w;UMax_w]$. Тогда $T2U_w(x)$ определяется следующим образом:
$$
T2U_w(x) = 
\begin{cases}
x \ \ \ \ \ \ \ \ \ , \ \ x >= 0 \\
x + 2^w, \ \ x < \ \ \ 0
\end{cases}
$$
---
Примеры:
* $T2U_8(128) = 128$
* $T2U_8(-64) = 2^8 + (-64) = 192$

### Преобразование беззнакового числа в число, представленое в дополнительном коде

Пусть $U2T_w(x)$ - отображение числа из диапазона $[UMin_w;UMax_w]$ в число из диапазона $[TMin_w;TMax_w]$. Тогда $U2T_w(x)$ определяется следующим образом:
$$
T2U_w(x) = 
\begin{cases}
x \ \ \ \ \ \ \ \ \ , \ \ x <= TMax_w \\
x - 2^w, \ \ x > \ \ \ TMax_w
\end{cases}
$$
---
Примеры:
* $T2U_8(127) = 127$
* $T2U_8(129) = 129 - 2^8 = -127$
## Расширение битового представления числа

Расширение битового представление числа - это операция увеличения длины битового вектора с сохранением его корректной интерпретации. Если более формально: 
* Пусть есть битовый вектор $v$ длины $w$ - $v_w$
* Определим операцию расширения как 
$$
E_{w'}(v_w)=v'_{w'}, w'>w \implies
B2U_{w'}(v')=B2U_{w}(v) \ \land \
B2T_{w'}(v')=B2T_{w}(v)
$$

### Расширение битового представления беззнакового числа

При расширении битового представления беззнакового числа новые биты являются нулевыми:

$$
E_{k}(v_w)=v'_{k}, k>w; \
v_{k-1}=v_{k-2}=...=v_{w + 1}=v_{w}=0
$$
---
Пример:
* $E_5([1,0,1])=[0,0,1,0,1]$

### Расширение битового представления числа, представленного в дополнительном коде

При расширении битового представления числа, представленного в дополнительном коде, новые биты совпадают с самым старшим битом начального числа:

$$
E_{k}(v_w)=v'_{k}, k>w; \
v_{k-1}=v_{k-2}=...=v_{w + 1}=v_{w}=v_{w-1}
$$
---
Пример:
* $E_5([1,0,1])=[1,1,1,0,1]$

## Усечение битового представления числа

Усечение битового представление - это отбрасывание нужного количество старших бит числа. Значение получившегося в результате усечения числа зависит от способа интерпретации получившегося битового представления. Далее буду приведены определения функции $T_k(v_w)$, которая усекает число, представленное битовым вектором $v$ длины $w$, до числа, представленного битовым вектором $v'$ длины $k$. 

### Усечение битового представления беззнакового числа

Усечение беззнакового числа, представленного битовым вектором $v$ длины $w$, до беззнакового числа, представленного битовым вектором $v'$ длины $k$, эквивалентно делению этого числа по модулю $2^k$:
$$
T_k(v_w)=v', \ k<w; \ B2U(v') = B2U(v) \ mod \ 2 ^k 
$$
---
Примеры:
* $T_8(512) = 512 \ mod \ 2^8 = 512 \ mod \ 256 = 0$
* $T_8(514) = 514 \ mod \ 2^8 = 514 \ mod \ 256 = 2$

### Усечение битового представления числа, представленного в дополнительном коде

Усечение числа в дополнительном коде, представленного битовым вектором $v$ длины $w$, до беззнакового числа, представленного битовым вектором $v'$ длины $k$, эквивалентно делению этого числа по модулю $2^k$:
$$
T_k(v_w)=v', \ k<w; \ B2T(v') = U2T(B2U(v) \ mod \ 2 ^k) 
$$
---
Примеры:
* $T_8(-511) = 1$
